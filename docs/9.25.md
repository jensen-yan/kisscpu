1. 今天花了很多时间尝试使用Clion来对C++文件进行调试, 但是失败了, 不过还是更加熟悉clion这个工具了吧, 只是现在对于Makefile的支持还不是特别好, 导致一直无法debug.
2. 还是回到主干部分, 继续编写五级流水线吧.
3. 看nutshell的debug代码的Makefile, 还是很奇怪啊, 似乎用了am, 但是ARCH不支持nutshell的框架啊. 然后也用了soder的test, 但是soder的要使用riscv-elf 的编译器, 安装一次似乎要6个G, 还能用别的方法吗?
   1. 使用soder的, 安装elf的, 直接编译, 但是如何装入内存中?
   2. 使用nutshell的, 再阅读下源代码, 使用am框架



#### 构建microbench

1. 在kisscpu下clone <https://github.com/OSCPU/nexus-am>  (这个和ics课程的am不同, 专用于nutshell的)

2. 修改am/arch/isa/riscv64.mk  参考<https://blog.csdn.net/weiqi7777/article/details/88045720#t5> 可以使用不同版本的编译器

   ```makefile
   # CROSS_COMPILE := riscv64-linux-gnu-
   CROSS_COMPILE := riscv64-unknown-linux-gnu-
   # 因为我电脑上只有这个的编译器, 可以改
   ```

3. 执行

   1. ```
      cd nexus-am/apps/microbench
      make ARCH=riscv64-nutshell mainargs=test run AM_HOME=/home/yanyue/nutshell_v2/kisscpu/nexus-am
      # 只改了AM_HOME, 还可以改别的
      ```

      会在apps/microbench/build中生成bin文件, txt文件等



bug:

每次读出来两条指令了, 并且拼在了一起!

为何生成的是32位的?

pc 到底应该每次+4还是+8???   

服了, 原来看官方手册, 64位汇编还是pc+4, 指令还是32位的.......

那么我仍然可以按照32位处理器来设计cpu, 只需要非常微小的改动就可以了

```
	80000000:	00000413          	li	s0,0
    80000004:	00009117          	auipc	sp,0x9
    80000008:	ffc10113          	addi	sp,sp,-4 # 80009000 <_end>
    8000000c:	034000ef          	jal	ra,80000040 <_trm_init>
    80000010:	00000513          	li	a0,0  // 不该走
    80000014:	00008067          	ret	// jalr x0, x1, 0
    
    80000040:	ff010113          	addi	sp,sp,-16
    80000044:	00113423          	sd	ra,8(sp)
    80000048:	014000ef          	jal	ra,8000005c <__am_init_uartlite>
    8000004c:	00001517          	auipc	a0,0x1
    80000050:	b2150513          	addi	a0,a0,-1247 # 80000b6d 
    80000054:	fbdff0ef          	jal	ra,80000010 <_etext>
    80000058:	fc5ff0ef          	jal	ra,8000001c <_halt>
```

